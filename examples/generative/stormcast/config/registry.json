{
    "models": {
        "u_v_q_t_w_nopos_crop128": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2s_v3_1_u_v_q_t_w_nopos_crop128-hrrr-gpus16/network-snapshot-000650.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2s_v3_1_u_v_q_t_w_nopos_crop128",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/best_ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "diffusion_only": "False",
            "regression_net_type": "swin",
            "description": "This model uses a swin model for regression and corrects u, v, q, t, w upto level 10 using the diffusion model",
            "notes": "current benchmark as of 2024-01-08"
        },
        "u_v_q_t_w_nopos_crop128_pstep": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2s_v3_1_u_v_q_t_w_nopos_crop128_pstep-hrrr-gpus16/network-snapshot-000870.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2s_v3_1_u_v_q_t_w_nopos_crop128_pstep",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/best_ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_net_type": "swin",
            "regression_config_name": "hrrr_v3_1",
            "diffusion_only": "False",
            "description": "This model uses a swin model for regression and corrects u, v, q, t, w upto level 10 using the diffusion model. The diffusion model is conditioned with the previous step in addition to the output of the swin model",
            "notes": "Unstable on rollout. Hallucinations build up"
        },
        "u_v_q_t_w_nopos_crop128_all_levels": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2s_v3_1_u_v_q_t_w_nopos_crop128_all_levels-hrrr-gpus16/network-snapshot-000560.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2s_v3_1_u_v_q_t_w_nopos_crop128_all_levels",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/best_ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "diffusion_only": "False",
            "regression_net_type": "swin",
            "description": "This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model",
            "notes": "still to be tested"
        },
        "full_diffusion_test": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_direct-hrrr-gpus16/network-snapshot-001558.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_direct",
            "posthoc_ema_sigma":"None",
            "diffusion_only": "True",
            "description": "This model uses no regression model and directly models u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model",
            "notes": "Failed prelim diagnostics"
        },
        "diffusion_regression_a2a_v3_1_tune": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/2-diffusion_regression_a2a_v3_1_tune-hrrr-gpus64/network-snapshot-013803.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_tune",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/best_ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "regression_net_type": "swin",
            "diffusion_only": "False",
            "description": "Training stabilized with gradient clipping allows the model to train for longer. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model",
            "notes": "still to be tested"
        },
        "diffusion_regression_a2a_v3_1_tune_pmean0": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_tune_pmean_0-hrrr-gpus64/network-snapshot-004515.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_tune",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/best_ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "regression_net_type": "swin",
            "diffusion_only": "False",
            "description": "Training stabilized with gradient clipping allows the model to train for longer. Inlcudes a finetuning protocol with a higher noise level. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model",
            "notes": "still to be tested"
        },
        "diffusion_regression_a2a_v3_1_tune_pmean0_noema": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_tune_pmean_0-hrrr-gpus64/training-state-004515.pt",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_tune",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/best_ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "regression_net_type": "swin",
            "diffusion_only": "False",
            "description": "Training stabilized with gradient clipping allows the model to train for longer. Inlcudes a finetuning protocol with a higher noise level. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model",
            "notes": "still to be tested"
        },
        "diffusion_regression_a2a_v3_1_log_residual_nocrop_4M_img": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/1-diffusion_regression_a2a_v3_1_log_residual_nocrop-hrrr-gpus64/network-snapshot-004985.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_log_residual_nocrop",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "regression_net_type": "swin",
            "diffusion_only": "False",
            "description": "Training diffusion model with logarithmically scaled resiudals from the swin regression model. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model. No cropping is used for the input data",
            "notes": "still to be tested"
        },
        "diffusion_regression_a2a_v3_1_log_residual_nocrop_4M_img_noema": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/1-diffusion_regression_a2a_v3_1_log_residual_nocrop-hrrr-gpus64/network-snapshot-004985.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_log_residual_nocrop",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "regression_net_type": "swin",
            "diffusion_only": "False",
            "description": "Training diffusion model with logarithmically scaled resiudals from the swin regression model. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model. No cropping is used for the input data",
            "notes": "still to be tested"
        },
        "power_ema_demo":{
            "edm_checkpoint_path": "/pscratch/sd/p/pharring/dev/diffusion/rundir/0-diffusion_regression_a2a_v3_1_tune-hrrr-gpus1",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_tune",
            "posthoc_ema_sigma":"0.17",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "regression_net_type": "swin",
            "diffusion_only": "False",
            "description": "Demo config for post-hoc ema"
        },
        "diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_pstd_2_0_5M_img": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_pstd_2_0-hrrr-gpus64/network-snapshot-005577.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_pstd_2_0",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "regression_net_type": "swin",
            "diffusion_only": "False",
            "description": "Training diffusion model with logarithmically scaled resiudals from the swin regression model. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model. No cropping is used for the input data. Conditioned on previous step. Adjusted log std to 2.0",
            "notes": "unstable on rollout, nans after a few timesteps"
        },
        "diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_pstd_2_0_7M_img": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_pstd_2_0-hrrr-gpus64/network-snapshot-006958.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_pstd_2_0",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_net_type": "swin",
            "regression_config_name": "hrrr_v3_1",
            "diffusion_only": "False",
            "description": "Training diffusion model with logarithmically scaled resiudals from the swin regression model. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model. No cropping is used for the input data. Conditioned on previous step. Adjusted log std to 2.0",
            "notes": "unstable on rollout, nans after a few timesteps"
        },
        "diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_4M_img": {
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_lr1em3-hrrr-gpus64/network-snapshot-003863.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_log_residual_nocrop_attn_pstep_pstd_2_0",
            "posthoc_ema_sigma":"None",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments/hrrr_v3_1/1/training_checkpoints/ckpt.tar",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "hrrr_v3_1",
            "diffusion_only": "False",
            "regression_net_type": "swin",
            "description": "Training diffusion model with logarithmically scaled resiudals from the swin regression model. This model uses a swin model for regression and corrects u, v, q, t, w for all levels in the hrrr_v3_1 dataset using the diffusion model. No cropping is used for the input data. Conditioned on previous step.",
            "notes": "unstable on rollout, nans after a few timesteps"
        },
        "diffusion_regression_a2a_v3_1_exclude_w":{
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_exclude_w-hrrr-gpus64",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_exclude_w",
            "posthoc_ema_sigma":"0.001",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-regression_a2a_v3_1_exclude_w-hrrr-gpus32/network-snapshot-012280.pkl",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "regression_a2a_v3_1_exclude_w",
            "regression_net_type": "unet",
            "diffusion_only": "False",
            "description": "UNet regression and diffusion models, exclude w from training"
        },
        "diffusion_regression_a2a_v3_1_exclude_w_noema":{
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_exclude_w-hrrr-gpus64/network-snapshot-005425.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_exclude_w",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-regression_a2a_v3_1_exclude_w-hrrr-gpus32/network-snapshot-012280.pkl",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "regression_a2a_v3_1_exclude_w",
            "regression_net_type": "unet",
            "diffusion_only": "False",
            "description": "UNet regression and diffusion models, exclude w from training, no ema"
        },
        "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_noema":{
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed-hrrr-gpus64/network-snapshot-003378.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-regression_a2a_v3_1_exclude_w-hrrr-gpus32/network-snapshot-012280.pkl",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "regression_a2a_v3_1_exclude_w",
            "regression_net_type": "unet",
            "diffusion_only": "False",
            "description": "UNet regression and diffusion models, exclude w from training, no ema"
        },
        "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_direct_noema_13M":{
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/1-diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_direct-hrrr-gpus64/network-snapshot-013820.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_direct",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-regression_a2a_v3_1_exclude_w-hrrr-gpus32/network-snapshot-012280.pkl",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "regression_a2a_v3_1_exclude_w",
            "regression_net_type": "unet",
            "diffusion_only": "False",
            "description": "UNet regression and diffusion models, exclude w from training, no ema"
        },
        "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_direct_noema_15M":{
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/1-diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_direct-hrrr-gpus64/network-snapshot-015048.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_direct",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-regression_a2a_v3_1_exclude_w-hrrr-gpus32/network-snapshot-012280.pkl",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "regression_a2a_v3_1_exclude_w",
            "regression_net_type": "unet",
            "diffusion_only": "False",
            "description": "UNet regression and diffusion models, exclude w from training, no ema"
        },
        "pure_diffusion_a2a_v3_1_exclude_w_pstep_pos_embed_direct_noema_21M":{
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-pure_diffusion_a2a_v3_1_exclude_w_pstep_pos_embed_direct-hrrr-gpus64/network-snapshot-021605.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "pure_diffusion_a2a_v3_1_exclude_w_pstep_pos_embed_direct",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "diffusion_only": "True",
            "description": "UNet regression and diffusion models, exclude w from training, no ema"
        },
        "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_v2_noema_16M":{
            "edm_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_v2-hrrr-gpus64/network-snapshot-016892.pkl",
            "edm_config_file": "./config/hrrr_swin.yaml",
            "edm_config_name": "diffusion_regression_a2a_v3_1_exclude_w_pstep_pos_embed_v2",
            "posthoc_ema_sigma":"None",
            "force_no_ema": "True",
            "regression_checkpoint_path": "/pscratch/sd/j/jpathak/hrrr_experiments_eos/0-regression_a2a_v3_1_exclude_w_v2_noskip-hrrr-gpus32/network-snapshot-001023.pkl",
            "regression_config_file": "./config/hrrr_swin.yaml",
            "regression_config_name": "regression_a2a_v3_1_exclude_w_v2_noskip",
            "regression_net_type": "unet2",
            "diffusion_only": "False",
            "description": "UNet regression and diffusion model, exclude w from training, no ema, v2 regression, includes p, z vars in diffusion training"
        }
    }
}
